#!/usr/bin/env bash

if [ $UID -ne 0 ]; then
    PIP="sudo /usr/bin/pip3"
else
    PIP=pip3
fi

${PIP} install  -q --upgrade pip

REQS=${CI_WORKSPACE}/testpack/requirements.txt
if [ -f ${REQS} ]; then
    if [ $(grep -q "testpack_helper_library" ${REQS}; echo $?) -eq 0 ]; then
        echo "  Installing testpack_helper_library"
        cd /root/testpack_helper_library_module
        ${PIP} install -q .
        cd -
    fi

    echo "  Attempting to install python modules"
    ${PIP} install -qr ${REQS}
else
    echo "  No python modules to install"
fi
